<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>用户信息</title>
	<link rel="stylesheet" href="../static/lib/bootstrap-3.3.7-dist/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="../static/css/main.css" />
	<link rel="stylesheet" href="../static/css/user.css" />
	<link rel="shortcut icon" type="image/x-icon" href="../static/img/favicon.ico" />	
</head>
<body>
	<!--导航栏 -->
	<div class="navbar navbar-default">
		<div class="container container-change">	
			
			<div class="col-sm-3 navbar-header">
			<a href="index.html" class="navbar-brand"></a>
			</div>
			
			<ul class="col-sm-7 nav navbar-nav">				
				<!--<li><a href="user-index.html">首页</a></li>
				<li><a href="position.html">找职位</a></li>
				<li><a href="#">名企校招</a></li>
				<li><a href="#">宣讲会</a></li>
				<li><a href="#">空中宣讲会</a></li>-->
			</ul>	
			
			<div class="col-sm-2 btn-groupn navbar-right">
			  <a class="dropdown-toggle" data-toggle="dropdown" ><span class="glyphicon glyphicon-user" id="user_name"> </span></a>
			  <ul class="dropdown-menu dropdown-menu-left">
			    <li><a href="job.html">返回主页</a></li>
			    <li><a href="company-info.html">我的招聘</a></li>
			    <li role="separator" class="divider"></li>
			    <li><a href="login.html">退出</a></li>
			  </ul>	
			</div>
		
		</div>		
	</div>
	
	<!--个人-->	
	<div class="container user-info-top clearfix">
		<div class="col-sm-2 clearfix">
			<img src="../static/img/user.png" />
		</div>
		<div class="col-sm-8 clearfix">
			<p class="info-p1" id="userinfo_name"></p>
			<p class="info-p2">
			<span id="userinfo_email">邮箱：</span>
			<span id="userinfo_like">期望职位：</span>
			<span id="userinfo_role">目前职位：</span>
			</p>			
		</div>
		<div class="col-sm-1"></div>
		<div class="col-sm-1 user-info-top-a"><a data-toggle="modal" data-target="#UpdateModal" >编辑</a></div>
	</div>
	
	<div class="container user-info-nav clearfix " id="user_function">	
		<ul class="nav navbar-nav clearfix">				
			<li><a href="user-info.html" class="active">推荐</a></li>
			<li><a href="#" id="user_collect">收藏</a></li>
			<li><a href="#" id="user_history">历史</a></li>
			<li><a href="#" id="user_comment">评价</a></li>
		</ul>	
		
	</div>
			
	<div class="container  user-info">
		<div class="col-sm-9">
			<div class="user-info-right clearfix row" >
				
				<div class="user-list" id="user_function_info">	
					
					<div class="user-list-item1 "><span>|</span> 我的推荐</div>				
					
					<div class="container user-list-width" id="recommend_add">											
																		
					</div>					
					
					
				</div>
				
				
			</div>
		</div>
		
	</div>
                                                         
	<!--个人信息修改模态框 -->
	<div class="modal fade" id="UpdateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title" >个人信息修改</h4>
	            </div>
	            <div class="modal-body">
	            
	                <form class="form-horizontal">
	                    <div class="form-group">
	                        <label class="col-sm-2 control-label">姓名</label>
	                        <div class="col-sm-8">
	                            <input type="text" name="email" class="form-control" id="uname_update_input" >
	                            <span class="help-block"></span>
	                        </div>
	                    </div>	                    	      
	                    
	                    <div class="form-group">
	                        <label class="col-sm-2 control-label">邮箱</label>
	                        <div class="col-sm-8">
	                            <input type="text" name="email" class="form-control" id="email_update_input" placeholder="">
	                            <span class="help-block"></span>
	                        </div>
	                    </div>
	                    
	                    <div class="form-group">
	                        <label class="col-sm-2 control-label">期望职位</label>
	                        <div class="col-sm-8">
	                            <input type="text" name="email" class="form-control" id="epostion_update_input" >
	                            <span class="help-block"></span>
	                        </div>
	                    </div>
	                    
	                    <div class="form-group">
	                        <label class="col-sm-2 control-label">目前职位</label>
	                        <div class="col-sm-8">
	                            <input type="text" name="email" class="form-control" id="nposition_update_input" >
	                            <span class="help-block"></span>
	                        </div>
	                    </div>
	                    	                  
						
	                </form>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
	                <button type="button" class="btn btn-primary" id="emp_update_btn">确定</button>
	            </div>
	        </div>
	    </div>
	</div>
	
	<!--上传文件模态框 -->
	<div class="modal fade" id="cvUpdateFileModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title" >上传简历</h4>
	            </div>
	            <div class="modal-body">
	            
	                <form class="form-horizontal">
	                    <div class="form-group">
	                        <label class="col-sm-3 control-label">选择上传的文件</label>
	                        <div class="col-sm-8">
	                            <input type="file" name="email" class="form-control" id="email_update_input" >
	                            <span class="help-block"></span>
	                        </div>
	                    </div>
	                   			
	                </form>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
	                <button type="button" class="btn btn-primary" id="emp_update_btn">确定</button>
	            </div>
	        </div>
	    </div>
	</div>
	
    
	 <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="../static/lib/jquery/jquery-3.4.1.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="../static/lib/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
    <script>	
    	var userinfolist = ''
		var position = ''
    	
    	$("#user_function a").click(function(){
			$("#user_function a").removeClass("active");
			$(this).addClass("active");
		})
    	
    	//收藏
    	$("#user_collect").click(function(){
			$("#user_function_info").empty()
			$("#user_function_info").append($("<div class='user-list-item1'></div>").append($("<span>|</span>")).append(" 我的收藏"))							
									var date = sessionStorage.getItem('username')
									var recommendtemp = ''	
					
									for(var i = 0 ; i < userinfolist.length; i++){
														if(userinfolist[i].name==date){
															for(var z=0 ; z < userinfolist[i].position_collect.length; z++){
																for(var j=0; j < position.length; j++){
																	if(userinfolist[i].position_collect[z].id == position[j].id){
																		recommendtemp += '<div class="col-sm-4 user-list-rm">'+
																					 '<button id="position_infomation" position_id="'+position[j].id+'" class="user-list-title1">'+position[j].name+'</button>'+	
																					 '<button class="user-list-btn1"><span>取消收藏</span></button>'+
																					 '<div >'+ 								 
																					 '<div class="col-sm-5 row">'+
																					 '<img src="'+position[j].company.photo_addr+'" />'+
																					 '</div>'+									 
																					 '<div class="col-sm-7 user-list-title2">'+
																					 '<a href="#">'+position[j].company.name+'</a>'+
																					 '</div>'+					 
																					 '</div>'+
																					 '</div>' 
																	}
																}
															}	 
														}									
													}
					 				$("#user_function_info").append($("<div class='container user-list-width'></div>").append(recommendtemp))
																	
		})
    	
    	//历史
    	$("#user_history").click(function(){
			$("#user_function_info").empty()
			$("#user_function_info").append($("<div class='user-list-item1'></div>").append($("<span>|</span>")).append(" 浏览历史"))			
									var date = sessionStorage.getItem('username')
									var recommendtemp = ''	
					
									for(var i = 0 ; i < userinfolist.length; i++){
														if(userinfolist[i].name==date){
															for(var z=0 ; z < userinfolist[i].position_history.length; z++){
																for(var j=0; j < position.length; j++){
																	if(userinfolist[i].position_history[z].id == position[j].id){
																		recommendtemp += '<div class="col-sm-4 user-list-rm">'+
																					 '<button id="position_infomation" position_id="'+position[j].id+'" class="user-list-title1">'+position[j].name+'</button>'+			
																					 '<div >'+ 								 
																					 '<div class="col-sm-5 row">'+
																					 '<img src="'+position[j].company.photo_addr+'" />'+
																					 '</div>'+									 
																					 '<div class="col-sm-7 user-list-title2">'+
																					 '<a href="#">'+position[j].company.name+'</a>'+
																					 '</div>'+					 
																					 '</div>'+
																					 '</div>' 
																	}
																}
															}	 
														}									
													}
					 				$("#user_function_info").append($("<div class='container user-list-width'></div>").append(recommendtemp))							
		})
		
		//评价
		$("#user_comment").click(function(){
			$("#user_function_info").empty()
			$("#user_function_info").append($("<div class='user-list-item1'></div>").append($("<span>|</span>")).append(" 我的评分"))
									var date = sessionStorage.getItem('username')
									var recommendtemp = ''	
					
									for(var i = 0 ; i < userinfolist.length; i++){
														if(userinfolist[i].name==date){
															for(var z=0 ; z < userinfolist[i].position_comment.length; z++){
																for(var j=0; j < position.length; j++){
																	if(userinfolist[i].position_comment[z].id == position[j].id){
																		recommendtemp += '<div class="col-sm-4 user-list-rm">'+
																					 '<button id="position_infomation" position_id="'+position[j].id+'" class="user-list-title1">'+position[j].name+'</button>'+			
																					 '<button class="user-list-btn"><span>评分：'+position[j].position_grade+'</span></button>'+
																					 '<div >'+
																					 '<div class="col-sm-5 row">'+
																					 '<img src="'+position[j].company.photo_addr+'" />'+
																					 '</div>'+									 
																					 '<div class="col-sm-7 user-list-title2">'+
																					 '<a href="#">'+position[j].company.name+'</a>'+
																					 '</div>'+					 
																					 '</div>'+
																					 '</div>' 
																	}
																}
															}	 
														}									
													}
					 				$("#user_function_info").append($("<div class='container user-list-width'></div>").append(recommendtemp))															
		})
		
		$(function(){
			username_add()
			userinfo_build()
			getinfo()
			recommend_add()
    			
    		//增加名字
				function username_add(){
					var date = sessionStorage.getItem('username')
					$("#user_name").append(date)
				}
				
			//个人信息
				function userinfo_build(){
					var date = sessionStorage.getItem('username')
					$.ajax({
						type:"get",
						url:"../static/date/user.json",
						dataType:"json",
						success:function(result){
							var userinfolist = result.user
							for (var i = 0; i<userinfolist.length; i++) {
								if(userinfolist[i].name == date){
									$("#userinfo_name").append(userinfolist[i].name).append('<span class="glyphicon glyphicon-check"></span>')
									$("#userinfo_email").append(userinfolist[i].email)
									$("#userinfo_like").append(userinfolist[i].like_position)
									$("#userinfo_role").append(userinfolist[i].role)
								}
							}	
						}
					})
				}
				
			//推荐信息
				function recommend_add(){	
					var date = sessionStorage.getItem('username')
					var recommendtemp = ''	
					
					for(var i = 0 ; i < userinfolist.length; i++){
										if(userinfolist[i].name==date){
											for(var z=0 ; z < userinfolist[i].position_recomment.length; z++){
												for(var j=0; j < position.length; j++){
													if(userinfolist[i].position_recomment[z].id == position[j].id){
														recommendtemp += '<div class="col-sm-4 user-list-rm">'+
																	 '<button id="position_infomation" position_id="'+position[j].id+'" class="user-list-title1">'+position[j].name+'</button>'+								 
																	 '<div >'+ 								 
																	 '<div class="col-sm-5 row">'+
																	 '<img src="'+position[j].company.photo_addr+'" />'+
																	 '</div>'+									 
																	 '<div class="col-sm-7 user-list-title2">'+
																	 '<a href="#">'+position[j].company.name+'</a>'+
																	 '</div>'+					 
																	 '</div>'+
																	 '</div>' 
													}
												}
											}	 
										}									
									}
					 $("#recommend_add").append(recommendtemp)		 					 
			 }	
			
			function getinfo(){
					 $.ajax({
					 			async:false,
								type:"get",
								url:"../static/date/user.json",
								dataType:"json",				
								success:function(result){
									userinfolist = result.user								
								}
							})	
							
					 $.ajax({
					 			async:false,
								type:"get",
								url:"../static/date/job.json",
								dataType:"json",
								success:function(result){
									position = result.position							
								}
						})
			}
		})
		
		$(document).on("click","#position_infomation",function (){
				var position_id = $(this).attr("position_id")
				location.href="position-info.html?"+"id="+encodeURI(position_id)
			})
		
    </script>
    <!--自己的插件 -->
    <script src="../static/js/index.js"></script>
</body>
</html>
	